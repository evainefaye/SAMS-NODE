<html>
    <head>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script>
        <script>
            var socket = io.connect('http://evainefaye.ddns.net:5501')

            // Function to do upon Connection being detected by the server
            socket.on('Announce Connection',function(data) {
                ConnectionId = data.ConnectionId;
                UserInfo = new Object();
                UserInfo.ConnectionId = ConnectionId;
                UserInfo.AttUID = "sm538x"; // attUID
                UserInfo.AgentName = "Stephanie Martinez"; // agentName
                UserInfo.LocationCode = "AUSTX"; // locationCode
                UserInfo.SmpSessionId = "123-456-789"; // smpSessionId;
                // UserInfo.SkillGroup = ""; // skillGroup
                // UserInfo.ConnectTime = ""; // connectionTime
                // UserInfo.SessionStartTime = ""; //sessionStartTime
                // UserInfo.FlowName = ""; // flowName
                // UserInfo.NodeName = ""; // nodeName
                // UserInfo.NodeStartTime = ""; // nodeStartTime
                UserInfo.FlowHistory = new Array();
                UserInfo.NodeHistory = new Array();
                // UserInfo.FlowHistory = ""; // Array of flow names visited
                // UserInfo.NodeHistory = ""; // Array of node names visited
                
                // Erase Activity in case you are reconnecting, we are going to populate the entire history
                $('div ul#activity').empty();
                socket.emit('Announce Sasha Connection', {
                    ConnectionId: ConnectionId,
                    UserInfo: UserInfo
                });
                // Display to the connecting user a welcome
                $('div#greeting').append('Welcome ' + ConnectionId);
            });

            // Show that a user has connected
            socket.on('Show Activity Connection', function(data) {
                ConnectionId = data.ConnectionId;
                $('div ul#activity').append('<li>Connection: ' + ConnectionId + '</li>');                
            });

            // Show that a user has disconnected
            socket.on('Show Activity Disconnection', function(data) {
                ConnectionId = data.ConnectionId;
                $('div ul#activity').append('<li>Disconnection: ' + ConnectionId + '</li>');                
            });

            // Show the list of conneted users in the SashaUsers Object
            socket.on('Show Connected Sasha Users', function(data) {
                SashaUsers = data.SashaUsers;
                $('div ul#clients').empty();
                $.each(SashaUsers, function (key, value) {
                    $('div ul#clients').append('<li>ConnectionId: ' + value.ConnectionId + '</li>');
                    $('div ul#clients').append('<li>ATT UID: ' + value.AttUID + '</li>');
                    $('div ul#clients').append('<li>Agent Name: ' + value.AgentName + '</li>');
                    $('div ul#clients').append('<li>Location Code: ' + value.LocationCode + '</li>');
                    $('div ul#clients').append('<li>SMP SessionId: ' + value.SmpSessionId + '</li>');
                    $('div ul#clients').append('<li>Connect Time: ' + value.ConnectTime + '</li>');
                    $('div ul#clients').append('<li></li>');
                });
            });

            // Display the Activity History Object to connecting client
            socket.on('Show Activity History', function(data) {
                ActivityHistory = data.ActivityHistory;
                $.each(ActivityHistory, function(index, value) {
                    $('div ul#activity').append('<li>' + value + '</li>');
                });
            });
        </script>
    </head>
    <body>
        <div>
            <div id='greeting'></div>
            <ul id='clients'>
            </ul>
            <ul id='activity'>
            </ul>
        </div>
    </body>
</html>